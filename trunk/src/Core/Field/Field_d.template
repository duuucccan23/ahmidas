namespace Core
{
  template< typename Element, size_t L, size_t T >
  void Field< Element, L, T >::decreaseIdx(short *idx) const
  {
    if (--idx[idx_Z] >= 0)
      return;
    idx[idx_Z] += d_grid.dim(idx_Z);
    if (--idx[idx_Y] >= 0)
      return;
    idx[idx_Y] += d_grid.dim(idx_Y);
    if (--idx[idx_X] >= 0)
      return;
    idx[idx_X] += d_grid.dim(idx_X);
    --idx[idx_T];
  }
}
